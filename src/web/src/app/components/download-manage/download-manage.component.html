<div class="title">三个任务正在进行</div>
<div class="list" *ngIf="jobs$|async as $jobs">
  <ng-container *ngFor="let job of $jobs">
      <div class="item" *ngIf="job.name|appInfo|async as $app">
        <img class="icon" [src]="metadataServer + '/' + $app.icon">
        <div class="content">
          <div class="appInfo">
            <div class="name">
              {{$app.name}}
            </div>
            <div class="version">
              10.61.1
            </div>
          </div>
          <div class="time">
              剩余时间：
              <span *ngIf="job.size$|async as $size;else $wait">
                {{job.speed>0 ? ($size*(1-job.progress*2)/job.speed).toFixed(0) : 0}}秒
              </span>
              <ng-template #$wait>
                --
              </ng-template>
          </div>
          <div class="progressInfo">
            <progress [value]="job.progress*2" max="1"></progress>
            <div class="speed" *ngIf="job.status=='running' && job.type=='download';else $msg">
              <span *ngIf="job.size$|async as $size">
                {{($size*job.progress)|sizeHuman}} / {{$size|sizeHuman}} 
              </span>
              <span>{{job.speed|sizeHuman}}/S</span>
            </div>
            <ng-template #$msg>
              <div class="message" [class.failed]="job.status=='failed'">
                  {{progressMessage[job.type][job.status]}}
              </div>
            </ng-template>
          </div>
          <div class="controlBtn">
            <ng-container [ngSwitch]="true">
              <button class="pauseBtn" (click)="pause(job.id);$event.target.disabled=true" *ngSwitchCase="job.status=='running' || job.status=='ready'" [disabled]="job.status=='install'"></button>
              <button class="startBtn" (click)="start(job.id);$event.target.disabled=true" *ngSwitchCase="job.status=='paused'" ></button>
              <button class="restartBtn" (click)="start(job.id)" *ngSwitchCase="job.status=='failed'"></button>
            </ng-container>
            <button class="cancelBtn" [disabled]="!job.cancelable" (click)="cancel(job.id)"></button>
          </div>
        </div>
      </div>
  </ng-container>
</div>
<!-- <div class="list" *ngIf="appsObs|async as apps">
  <div class="item" *ngFor="let app of apps">
    <img class="icon" [src]="metadataServer+'/'+app.icon">
    <div class="content">
      <div class="appInfo">
        <span class="name">火狐浏览器</span>
        <span class="version">版本:10.1</span>
      </div>
      <div class="time">剩余时间：56秒</div>
      <div class="progressInfo">
        <progress value="5" max="100"></progress>
        <div class="speed">
          <span>4.2/50.2MB</span>
          <span>420kb/S</span>
        </div>
      </div>
      <div class="btnGroup">
        <div class="control"></div>
        <span class="close">X</span>
      </div>
    </div>
  </div>
</div> -->
